<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Javascript DOM事件详解 - 肖郎的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Javascript中DOM的全称是Document Object Model，即文档对象模型。DOM是一种将XML或HTML文档解析成树形节点的方法。DOM事件是文档、文档元素以及与用户交互产生的一系列的行为。当这些行为发生的时候，如果我们对这些行为做出相应的处理就会实现我们的一些实际开发中的需求，例如一些特效。DOM事件处理主要包含这3个方面：事件流，事件处理程序以及事件对象。">
<meta property="og:type" content="article">
<meta property="og:title" content="Javascript DOM事件详解">
<meta property="og:url" content="http://shawlang.github.io/2015/07/25/Javascript-DOM事件详解/index.html">
<meta property="og:site_name" content="肖郎的博客">
<meta property="og:description" content="Javascript中DOM的全称是Document Object Model，即文档对象模型。DOM是一种将XML或HTML文档解析成树形节点的方法。DOM事件是文档、文档元素以及与用户交互产生的一系列的行为。当这些行为发生的时候，如果我们对这些行为做出相应的处理就会实现我们的一些实际开发中的需求，例如一些特效。DOM事件处理主要包含这3个方面：事件流，事件处理程序以及事件对象。">
<meta property="og:image" content="http://www.designerspics.com/wp-content/uploads/2015/07/oranges_free_photo.jpg">
<meta property="og:updated_time" content="2015-08-13T18:06:28.315Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Javascript DOM事件详解">
<meta name="twitter:description" content="Javascript中DOM的全称是Document Object Model，即文档对象模型。DOM是一种将XML或HTML文档解析成树形节点的方法。DOM事件是文档、文档元素以及与用户交互产生的一系列的行为。当这些行为发生的时候，如果我们对这些行为做出相应的处理就会实现我们的一些实际开发中的需求，例如一些特效。DOM事件处理主要包含这3个方面：事件流，事件处理程序以及事件对象。">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">存档</a>
        
          <a class="main-nav-link" href="/categories">分类</a>
        
          <a class="main-nav-link" href="/tags">标签</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
          <a class="main-nav-link" href="/sideproject">个人项目</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <input type="text" class="st-default-search-input" />
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer"><article id="post-Javascript-DOM事件详解" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Javascript DOM事件详解
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/07/25/Javascript-DOM事件详解/" class="article-date">
  <time datetime="2015-07-25T12:54:18.000Z" itemprop="datePublished">2015-07-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a><span>></span><a class="article-category-link" href="/categories/Javascript/DOM事件/">DOM事件</a>
  </div>

      
        <div class="article-comment-link-wrap">
          <a href="http://shawlang.github.io/2015/07/25/Javascript-DOM事件详解/#disqus_thread" class="article-comment-link">评论</a>
        </div>
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://www.designerspics.com/wp-content/uploads/2015/07/oranges_free_photo.jpg" alt="鲜嫩的橙子"><br>Javascript中DOM的全称是Document Object Model，即文档对象模型。DOM是一种将XML或HTML文档解析成树形节点的方法。DOM事件是文档、文档元素以及与用户交互产生的一系列的行为。当这些行为发生的时候，如果我们对这些行为做出相应的处理就会实现我们的一些实际开发中的需求，例如一些特效。DOM事件处理主要包含这3个方面：事件流，事件处理程序以及事件对象。</p>
<a id="more"></a>
<h3 id="一、事件流">一、事件流</h3><ol>
<li>事件流概念：指页面中接收事件的顺序。值得注意的是文档中所有的元素都是“同命运，共呼吸”的。只要发生了事件，所有有“父子关系”的元素都会接收到。只是各种浏览器接收事件的顺序不同而已。</li>
<li>种类：一个是事件冒泡，从最具体的元素开始逐级往上传递，整个过程类似于“寻找祖先”一级一级往上查找；一个是事件捕获，从最不具体的元素也就是从根元素逐级子元素传递，就像祖先有一个宝贝需要一代代往下传一样。</li>
</ol>
<hr>
<h3 id="二、事件处理程序">二、事件处理程序</h3><p>主要包含3种事件处理方式：内联的HTML事件处理、DOM0级事件处理、DOM2级事件处理</p>
<h6 id="1、内联HTML事件处理">1、内联HTML事件处理</h6><p>内联HTML事件处理与内联样式差不多。主要格式类似于 <code>&lt;h1 onclick=&quot;clickme()&quot;&gt;click here&lt;/h1&gt;</code>。因为都是内联的，所以缺点与内联样式是差不多的，JS与HTML高度耦合，没有分离。</p>
<h6 id="2、DOM0级事件处理">2、DOM0级事件处理</h6><p>在W3C标准产生之前，各大浏览器对于访问文档元素的方法有些不同，所以把W3C标准产生之前的这些方法和标准称之为DOM level 0。而当w3c DOM1级标准出现后，因为DOM0级已经有很大一部分是DOM1级的一部分。所以习惯上把DOM0级和DOM1级统称为DOM0级。</p>
<pre><code><span class="comment">//实现的方法是：把事件处理函数赋值给元素的属性</span>
&lt;input type=<span class="string">"button"</span> id=<span class="string">"btn"</span> /&gt;
<span class="keyword">var</span> btn=<span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);
btn.onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{
    alert(<span class="string">"I'm button"</span>);
}

<span class="comment">//其中最典型的例子是页面加载后的处理事件</span>
<span class="built_in">window</span>.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{
    alert(<span class="string">"弹出是不是这样做的呢？"</span>);
}

<span class="comment">//清除事件处理程序</span>
<span class="built_in">window</span>.onload=<span class="literal">null</span>;
</code></pre><h6 id="3、DOM2级事件处理">3、DOM2级事件处理</h6><p>DOM2事件处理的主要通过<code>addEventListener()</code>和<code>removeEventListener</code>。这里注意的是使用<code>addEventListener</code>添加事件处理程序的个数是任意的，并且各个程序之间互不影响且按照顺序执行。</p>
<pre><code><span class="comment">//添加事件：addEventListener()</span>
&lt;input type=<span class="string">"button"</span> id=<span class="string">"btn"</span> value=<span class="string">"LogIn"</span> /&gt;
<span class="keyword">var</span> btn=<span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);
<span class="function"><span class="keyword">function</span> <span class="title">showMeCode</span>(<span class="params"></span>)</span>{
    alert(<span class="keyword">this</span>.value);
}
btn.addEventListener(<span class="string">'click'</span>,showMeCode,<span class="literal">false</span>);
</code></pre><p>因此，addEventListener的使用格式为：element.addEventListener(eventType,handler,bool)。bool值为True，表示事件流采用事件捕捉；bool值为False，表示事件流采用事件冒泡。</p>
<p>注意：<br>1)eventType，如click,mouseover,keyup,这个与DOM0级事件不同，事件名前不加<code>on</code><br>2)handler，如showMeCode后面没有<code>()</code>。</p>
<pre><code><span class="comment">//移除事件: removeEventListener()</span>
btn.removeEventListener(<span class="string">'click'</span>,showMeCode,<span class="literal">false</span>); 
<span class="comment">//移除事件处理程序 参数原封不动。</span>
</code></pre><h6 id="4、低版本的IE浏览器（&lt;=IE8以及OPERA）DOM2级事件处理">4、低版本的IE浏览器（&lt;=IE8以及OPERA）DOM2级事件处理</h6><p>低版本的IE浏览器注意使用<code>attachEvent()</code>和<code>detachEvent</code>。</p>
<pre><code><span class="keyword">var</span> btn=<span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);
<span class="function"><span class="keyword">function</span> <span class="title">showMsg</span>(<span class="params"></span>)</span>{
    alert(<span class="keyword">this</span>.value);
}
btn.attachEvent(<span class="string">'onclick'</span>,showMsg);
btn.detachEvent(<span class="string">'onclick'</span>,showMsg);
</code></pre><p>基本调用格式是：element.attachEvent(‘on’+type,handler)。<br>注意：1）事件类型之前必须加<code>on</code> 2)没有bool值，因为低版本的浏览器只支持事件冒泡</p>
<h6 id="5、跨浏览器的事件处理方法">5、跨浏览器的事件处理方法</h6><pre><code><span class="comment">//添加事件处理程序</span>
<span class="keyword">function</span> addEvent(element,<span class="class"><span class="keyword">type</span>,<span class="title">handler</span>){</span>
    <span class="keyword">if</span>(element.addEventListener){
        element.addEventListener(<span class="class"><span class="keyword">type</span>,<span class="title">handler</span>,<span class="title">false</span>);</span>
    }<span class="keyword">else</span> <span class="keyword">if</span>(element.attachEvent){
        element.attachEvent(<span class="class"><span class="keyword">type</span>,<span class="title">handler</span>);</span>
    }<span class="keyword">else</span>{
        element[on+'<span class="class"><span class="keyword">type</span>']</span>=handler;
    }
}

<span class="comment">//删除事件处理程序</span>
<span class="keyword">function</span> removeEvent(element,<span class="class"><span class="keyword">type</span>,<span class="title">handler</span>){</span>
    <span class="keyword">if</span>(element.removeEventListener){
        element.removeEeventListener(<span class="class"><span class="keyword">type</span>,<span class="title">handler</span>,<span class="title">false</span>);</span>
    }<span class="keyword">else</span> <span class="keyword">if</span>(element.detachEvent){
        element.detachEvent('on'+<span class="class"><span class="keyword">type</span>,<span class="title">handler</span>);</span>
    }<span class="keyword">else</span>{
        element[<span class="string">"on"</span>+<span class="class"><span class="keyword">type</span>]</span>=<span class="keyword">null</span>;
    }
}
</code></pre><hr>
<h3 id="三、事件对象">三、事件对象</h3><p>触发DOM事件的时候，默认的会产生一个事件对象（event），包含了例如在哪个元素、类型、目标等一系列特定信息。</p>
<h6 id="1、event常见的属性和方法">1、event常见的属性和方法</h6><p>属性：</p>
<blockquote>
<p>type:事件类型，例如是<code>click</code>还是<code>mouseover</code><br>  target: 事件元素<br>bubbles：返回布尔值，判断是否是冒泡事件流</p>
</blockquote>
<p>方法：</p>
<blockquote>
<p>initEvent(): 初始化新创建的Event对象的属性<br>  preventDefault(): 阻止默认行为<br>  stopPrapagation(): 阻止传播</p>
</blockquote>
<p>使用方法：</p>
<pre><code><span class="function"><span class="keyword">function</span> <span class="title">showMeCode</span><span class="params">(e)</span>{</span>
    alert<span class="params">(e.target)</span>;
    e.stopPropagation<span class="params">()</span>;
}
</code></pre><h6 id="2、低版本IE（&lt;=IE8）浏览器的事件对象的属性和方法">2、低版本IE（&lt;=IE8）浏览器的事件对象的属性和方法</h6><p>事件对象：window.event</p>
<p>属性：</p>
<blockquote>
<p>srcElement 对应于：target<br>  cancelBubble bool值<br>  returnValue bool值，为false的时候取消元素的默认动作</p>
</blockquote>
<p>更多事件对象的常用属性和方法，看这里<a href="http://www.w3school.com.cn/jsref/dom_obj_event.asp" target="_blank" rel="external">http://www.w3school.com.cn/jsref/dom_obj_event.asp</a></p>
<h6 id="3、跨浏览器的事件对象">3、跨浏览器的事件对象</h6><pre><code><span class="keyword">function</span> getEvent(<span class="literal">e</span>){
    <span class="keyword">return</span> <span class="literal">e</span>||window.<span class="literal">e</span>;
}
<span class="keyword">function</span> stopPropa(<span class="literal">e</span>){
    <span class="literal">e</span>=getEvent(<span class="literal">e</span>);
    <span class="keyword">if</span>(<span class="literal">e</span>.stopPropagation){
        <span class="literal">e</span>.stopPropagation();
    }<span class="keyword">else</span>{
        <span class="literal">e</span>.cancelBubble=<span class="literal">true</span>;
    }
}
<span class="keyword">function</span> preventDefault(<span class="literal">e</span>){
    <span class="literal">e</span>=getEvent(<span class="literal">e</span>);
    <span class="keyword">if</span>(<span class="literal">e</span>.preventDefault){
        <span class="literal">e</span>.preventDefault();
    }<span class="keyword">else</span>{
        <span class="literal">e</span>.returnValue=<span class="literal">false</span>;
    }
}
<span class="keyword">function</span> getTarget(<span class="literal">e</span>){
    <span class="literal">e</span>=getEvent(<span class="literal">e</span>);
    <span class="keyword">return</span> <span class="literal">e</span>.target||<span class="literal">e</span>.srcElement;
}
</code></pre><hr>
<h3 id="四、面向对象的跨浏览器事件处理程序">四、面向对象的跨浏览器事件处理程序</h3><pre><code>eventUtil={
    addHandler:<span class="function"><span class="keyword">function</span><span class="params">(element,type,handler)</span>{</span>
        <span class="keyword">if</span><span class="params">(element.addEventListener)</span>{
            element.addEventListener<span class="params">(type,handler,<span class="literal">false</span>)</span>;
        }<span class="keyword">else</span> <span class="keyword">if</span><span class="params">(element.attachEvent)</span>{
            element.attachEvent<span class="params">('on'+type,handler)</span>;
        }<span class="keyword">else</span>{
            element[<span class="string">"on"</span>+type]=handler;
        }
    },
    removeHandler:<span class="function"><span class="keyword">function</span><span class="params">(element,type,handler)</span>{</span>
        <span class="keyword">if</span><span class="params">(element.removeEventListener)</span>{
            element.removeEventListener<span class="params">(type,handler,<span class="literal">false</span>)</span>;
        }<span class="keyword">else</span> <span class="keyword">if</span><span class="params">(element.detachEvent)</span>{
            element.detachEvent<span class="params">(<span class="string">"on"</span>+type,handler)</span>;
        }<span class="keyword">else</span>{
            element[<span class="string">"on"</span>+type]=null;
        }
    },
    stopPropa:<span class="function"><span class="keyword">function</span><span class="params">(e)</span>{</span>
        <span class="keyword">if</span><span class="params">(e.stopPropagation)</span>{
            e.stopPropagation<span class="params">()</span>;
        }<span class="keyword">else</span>{
            e.cancelBubble=<span class="literal">true</span>;
        }
    },
    preventDefault:<span class="function"><span class="keyword">function</span><span class="params">(e)</span>{</span>
        <span class="keyword">if</span><span class="params">(e.preventDefault)</span>{
            e.preventDefault<span class="params">()</span>;
        }<span class="keyword">else</span>{
            e.returnValue=<span class="literal">false</span>;
        }
    },
    getEvent:<span class="function"><span class="keyword">function</span><span class="params">(e)</span>{</span>
        return e?e:window.e;
    }
    getTarget:<span class="function"><span class="keyword">function</span><span class="params">(e)</span>{</span>
        return e.target||e.srcElement;
    }
}

<span class="comment">//实例</span>
var btn=document.getElementById<span class="params">('btn')</span>;
<span class="function"><span class="keyword">function</span> <span class="title">showMeCode</span><span class="params">(e)</span>{</span>
    alert<span class="params">(eventUtil.getTarget<span class="params">(e)</span>)</span>;
}
eventUtil.addHandler<span class="params">(btn,'click',showMeCode)</span>;
</code></pre><h3 id="五、总结">五、总结</h3><p>以前也学过，但却朦朦胧胧的。这次彻底理解了DOM事件处理。主要要理解的是触发一个事件，所有父子元素都会受到“牵连”，可以通过bool值来确定冒泡还是事件捕获事件流。</p>

      
    </div>
  
    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dom事件处理/">dom事件处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/08/13/IE浏览器兼容性测试工具/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          前端开发浏览器兼容性测试工具
        
      </div>
    </a>
  
  
    <a href="/2015/07/02/Django开发学习笔记03/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Django开发学习笔记03&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 shawlang&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>

</footer>
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','hpwehiRPuuBriefhgg56','2.0.0');
</script>
    
<script>
  var disqus_developer=1;
  var disqus_shortname = 'shawlang';
  
  var disqus_url = 'http://shawlang.github.io/2015/07/25/Javascript-DOM事件详解/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>